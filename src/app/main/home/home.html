<div class="container" *ngIf="user">
	<div class="row">
		<div *ngIf="user" class="col-md-8 col-sm-7 col-xs-12">
			<div class="col-xs-12 bordered error-msg" id="errorMsgDisplay" style="display:none">
				<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> {{errorMsg}}
				<i class="fa fa-times" aria-hidden="true" (click)="closeErrorMsg()"></i>
			</div>
			<div class="col-xs-12 bordered welcome-msg typeEffect" id="welcomeMsgDisplay" *ngIf="afficheWelcome">
				<h3>Bienvenue chez Speegar!</h3>
				Nous voudrions vous remercier pour votre inscription et vous informer que <b>Speegar</b> est un site dédié à vous faire
				rire!
				<br>
				<!--span style="color:#991111">Ainsi il est interdit de partager des publications à caractère politique ou religieux.</span-->
				Depuis votre profil, vous pouvez partager n'importe quelle image ou vidéo pour propager le fou rire!
				<i class="fa fa-times" aria-hidden="true" (click)="closeWelcomeMsg()"></i>
			</div>

			<form class="col-xs-12 add-pub bordered noPadding" (ngSubmit)="publish()" [formGroup]="form" #f="ngForm">

				<div class="row add-row">
					<div class="col-md-12 col-xs-12 add-head">
						<div class="upper-form-add">
							<div class="not-btn">
								Ajouter une nouvelle publication
							</div>
							<div class="title-checkbox hidden-xs" (click)="enableTitlePost()">
								<span>Titre</span>
								<i class="fa" [class.fa-square-o]="!titleEnable" [class.fa-check-square-o]="titleEnable"></i>
							</div>
						</div>

					</div>
					<div class="col-md-12 col-xs-12 add-head noPadding" id="pub-holder">
						<div class="col-md-12 col-sm-12 col-xs-12 noPadding">
							<div class="user-img for-add" *ngIf="user.profilePictureMin" [ngStyle]="{'background-image': 'url(' + user.profilePictureMin + ')'}">
							</div>

							<div class="user-img for-add" *ngIf="!user.profilePictureMin" [ngStyle]="{'background-image': 'url(' + user.profilePicture + ')'}">
							</div>


							<input id="pub-title-input" placeholder="Titre" *ngIf="titleEnable" formControlName="publicationTitle">
							<!--textarea rows="3" placeholder="Votre blague ici.." id="pubText" formControlName="publicationText" (keyup)="checkPreviewLink()"> </textarea-->
							<textarea rows="3" placeholder="Votre blague ici.." id="pubText" style="display:none;" formControlName="publicationText"
								[(ngModel)]="publishText"> </textarea>
							<div class="textarea-publish" id="publishDiv" (keyup)="updatePublishText($event)" (paste)="updatePublishTextOnPaste($event)" contenteditable="true"
								placeholder="Votre blague ici.."></div>
							<div class="file-input-holder">
								<div class="file-input">
									<div class="ajout-img-holder">
										<img id="preview-image" height="70" width="100">
										<i class="fa fa-times delete-photo-post" aria-hidden="true" *ngIf="uploadedPicture" (click)="resetPublishPicture()"></i>

									</div>
								</div>

							</div>
							
							<div class="link-preview-loading" *ngIf="linkLoading">Chargement du lien</div>
							<div class="link-preview" *ngIf="link.isSet">
								<span>
										<i class="fa fa-times" aria-hidden="true" (click)="closeLinkAPI()"></i>
									</span>
								<div class="noPadding" *ngIf="link.image">
									<img class="img-preview" [src]="link.image" />
								</div>
								<div class="descriptions" *ngIf="!link.isGif">
									<a href="{{link.url}}"  target="_blank" ><h4>{{link.title}}</h4></a>
									<p>{{link.description}}</p>
									<a href="{{link.url}}" target="_blank" class="subLink">{{link.url}}</a>
								</div>
							</div>
							<div class="youtube-preview">

							</div>
						</div>

					</div>
					<div class="col-md-12 col-xs-12 add-head noPadding">
						<div class="col-md-5 col-xs-8 add-buttons">


							<span class="picture-pub-in" (click)="addPhoto()">
                        <i class="fa fa-picture-o"></i>
                    </span>

							<span class="hidden-xs" (click)="addPhotoGIF()">
                        <b class="gif-btn">GIF</b>
                    </span>

							<span class="youtube-video-in hidden-xs">
                        
                        
                        
                                <input class="yt-in-url youtube-input-popup" 
                                        placeholder="youtube.com/watch?v=XXXXXX"
                                        style="display:none;"
                                        (change)="updateYoutube()"
                                        formControlName="publicationYoutubeLink">
                            
                        
                        <i class="fa fa-youtube-play" (click)="changeYoutubeInput()"></i>
                    </span>


							<input type="file" id="file-image" style="display:none" accept="image/*" (change)="uploadPhoto($event)">
							<input type="file" id="file-image-gif" style="display:none" accept=".gif" (change)="uploadPhotoGIF($event)">
						</div>
						<div class="col-md-7 col-xs-4 share-button">

							<div class="dropdown hidden-sm hidden-xs" (click)="enableSelectMenu()">
								<div>
									<header (click)="disableSelectMenu()">
										Qui peut voir ça?
									</header>
									<div [class.hide]="selectedMenuElement!=0">
										<i class="fa fa-globe"></i> Tout le monde
									</div>
									<div [class.hide]="selectedMenuElement!=1">
										<i class="fa fa-users"></i> Les abonnés
									</div>
									<div class="select-menu" style="display:none;">
										<header (click)="disbaleSelectMenu()">
											Qui peut voir ça?
										</header>
										<div class="select-choice" (click)="changeSelectMenu(0)">
											<i class="fa fa-globe"></i> Tout le monde
										</div>
										<div class="select-choice" (click)="changeSelectMenu(1)">
											<i class="fa fa-users"></i> Les abonnés
										</div>
									</div>
								</div>
								<i class="fa fa-caret-down"></i>
							</div>
							<div class="change-privacy hidden-lg hidden-md hidden-sm">
								<i class="fa fa-globe" [class.hide]="selectedMenuElement!=0" (click)="changeSelectMenu(1)"></i>
								<i class="fa fa-users" [class.hide]="selectedMenuElement!=1" (click)="changeSelectMenu(0)"></i>

							</div>
							<button class="publish-button" type="submit" *ngIf="!loadingPublish">Publier
                            </button>
							<button class="publish-button loading-button" *ngIf="loadingPublish" disabled>
                                <div class="loading"></div>
                            </button>
						</div>
					</div>


				</div>



			</form>

			<section id="publications" class="col-xs-12 noPadding" style="height: 100%">
				<div class="filters hidden-xs">
					<div class="filter-right">
						<article [class.active]="menuFilter == 'recent'" (click)="changeMenuFilter('recent')">
							Plus recent
						</article>
						<article [class.active]="menuFilter == 'popular'" (click)="changeMenuFilter('popular')">
							Populaire
						</article>
					</div>
				</div>

				<div *ngIf="user" infinite-scroll [infiniteScrollDistance]="1" [infiniteScrollThrottle]="0" (scrolled)="onScrollDown()">
					<publication *ngFor=" let publicationBean of publicationBeanList" [publicationBean]="publicationBean"></publication>
				</div>


				<!-- Loading-->
				<div class="publications-holder" id="publication" *ngIf="showLoading">
					<article class="publication bordered">

						<div class="user">
							<div class="user-img bgAnimated">
							</div>
							<div class="user-name bgAnimated" style="width:40%;height:10px;">
							</div>

						</div>
						<div class="content">
							<h4 class="bgAnimated" style="width:40%;height:10px;"></h4>
							<h4 class="bgAnimated" style="width:55%;height:10px;"></h4>
							<h4 class="bgAnimated" style="width:65%;height:10px;"></h4>

						</div>
					</article>
				</div>


				<div *ngIf="showErreurConnexion" class="col-xs-12 publication bordered">
					<div class="erreur" style="text-align:center;color:red">
						Oops ! pas de connexion
						<a (click)="reLoadposts()">
                        essayez de reconnecter ?
                        </a>
					</div>
				</div>



			</section>
		</div>
		<div *ngIf="user" class="col-md-4 col-sm-5 hidden-xs side-home">
			<top-blagueurs-decov></top-blagueurs-decov>
		</div>
	</div>
</div>